<link rel="import" href="polymer-require.html">

<polymer-element
    name="app-shortcuts"
    horizontal center-justified layout>
  <template>
    <link rel="stylesheet" href="../css/app-shortcuts.css">

    <core-overlay id="overlay">
      <div class="title">Keyboard Shortcuts</div>
      <template repeat="{{shortcut in listed}}">
        <div class="key" horizontal layout>
          <div class="shortcut">{{shortcut.binding}}</div>
          <div class="text">{{shortcut.name}}</div>
        </div>
      </template>
    </core-overlay>
  </template>
  <script>
  Polymer.require('app-shortcuts',
    ['base/bus', 'base/key', 'shortcuts'],
    function(bus, Key, Shortcuts) {
      return {
        evt: 'Shortcuts',
        listed: [],

        ready: function() {
          this.listed = Shortcuts.all;
          window.bus.register(this, this.evt);
          this.$.overlay.close();
        },
        onShortcuts: function(data) {
          this.$.overlay.open();
        },
        keypress: function(Key, e, detail, sender) {
          var
            key = Key.fromEvent(e),
            shortcut = Shortcuts.map[key.toString()];
          if (shortcut === undefined) return;
          if (this.isDebug) console.log('keypress', key, shortcut)
          if (shortcut) window.bus.broadcast(shortcut.intent);
        }
      };
  });
  </script>
</polymer-element>