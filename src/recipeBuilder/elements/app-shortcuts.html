<link rel="import" href="../bower_components/polymer/polymer.html">

<polymer-element
    name="app-shortcuts"
    attributes="isHidden"
    horizontal center-justified layout>
  <template>
    <link rel="stylesheet" href="../css/app-shortcuts.css">
    <div class="key-container">
      <template repeat="{{shortcut in shortcuts}}" >
        <div class="key-shortcut" horizontal layout>
          <div class="key-binding">{{shortcut.binding}}</div>
          <div class="key-description">{{shortcut.name}}</div>
        </div>
      </template>
    </div>
  </template>
  <script>
  Polymer('app-shortcuts', {
    isHidden: true,
    shortcuts: [
      {
        binding: 'alt+S',
        name: 'Create new step',
        intent: 'CreateStep'
      },
      {
        binding: 'shift+6',
        name: 'Toggle Visibility of Shortcuts',
        intent: 'Shortcuts'
      }
    ],
    map: {},
    ready: function() {
      require(['base/bus', 'base/key'], this.onReady.bind(this));
    },
    onReady: function(bus, Key) {
      this.shortcuts.forEach(function(s) { this.map[s.binding] = s; }, this);
      window.bus.register(this, this.toggleVisibility, 'Shortcuts');
    },
    keypress: function(Key, e, detail, sender) {
      var
        key = Key.fromEvent(e),
        shortcut = this.map[key.toString()];

      if (shortcut) window.bus.broadcast(shortcut.intent);
    },
    toggleVisibility: function() {
      this.isHidden = !this.isHidden;
    }
  });
  </script>
</polymer-element>