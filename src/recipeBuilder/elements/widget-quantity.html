<link rel="import" href="polymer-require.html">

<link rel="import" href="widget-units.html">

<polymer-element
    name="widget-quantity"
    attributes="quantity"
    horizontal layout center>
  <template>
    <link rel="stylesheet" href="../css/widget-quantity.css">

    <div flex>amount :</div>
    <input is="core-input" type="number" value="{{val}}" committedValue="{{commited}}"></input>
    <widget-units unit="{{unit}}"></widget-units>
  </template>
  <script>
  Polymer.require('widget-quantity',
    ['base/bus', 'base/quantity', 'base/units'],
    function(bus, Quantity, Units) {
      return {
        val: 0,
        commited: 0,
        unit: undefined,
        quantity: undefined,

        commitedChanged: function(oldVal, newVal) { this.check(); },
        unitChanged: function(oldVal, newVal) { this.check(); },
        isValid: function() {
          return this.unit !== undefined && this.commited !== 0 && this.unit !== Units.unknown;
        },
        check: function() {
          if (!this.isValid()) return;
          this.quantity = new Quantity(this.commited, this.unit);
        }
      };
  });
  </script>
</polymer-element>