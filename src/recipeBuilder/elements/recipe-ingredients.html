<link rel="import" href="polymer-require.html">

<link rel="import" href="../bower_components/core-list/core-list.html">

<polymer-element name="recipe-ingredients" attributes="inventory recipe" vertical layout>
  <template>
    <link rel="stylesheet" href="../css/recipe-ingredients.css">
    <div class="section">{{inventory.name}}</div>
    <core-list data="{{inventory.stocks}}" flex>
      <template>
        <div class="ingredient"><b>{{model.concept.name}}</b>&lt;{{model.quantity}}&gt;</div>
      </template>
    </core-list>
    <template repeat="{{reactor in recipe.reactors}}">
      <div class="section">{{reactor.src.name}}</div>
      <core-list data="{{reactor.src}}" flex>
        <template>
          <div class="ingredient"><b>{{model.concept.name}}</b>&lt;{{model.quantity}}&gt;</div>
        </template>
      </core-list>
    </template>
  </template>
  <script>
    /**
     * This recipe ingredient item is the right toolbar for currently available ingredient.
     */
    Polymer('recipe-ingredients', {
      data: [],
      groups: [],

      recipeChanged: function() {
        console.log(this.recipe);
      },

      ingredientsChanged: function(a, b) {
        b.inventory.forEach(function(item) { this.data.push(item); }, this);
        this.groups.push({
          length: b.inventory.length,
          data: {name: 'Inventory'}
        });
        b.reactors.forEach(function(reactor) {
          reactor.ingredients.forEach(function(item) { this.data.push(item); }, this);
          this.groups.push({
            length: reactor.ingredients.length,
            data: { name: reactor.name }
          });
        }, this);
      }
    });
  </script>
</polymer-element>