<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/core-list/core-list.html">
<link rel="import" href="../bower_components/core-overlay/core-overlay.html">

<polymer-element
    name="widget-list"
    attributes="data selection"
    vertical layout>
  <template>
    <link rel="stylesheet" href="../css/widget-list.css">

    <core-list id="list" data="{{data}}" selection="{{selection}}" height="30" flex>
      <template>
        <div class="item {{ {selected: selected} | tokenList }}" horizontal layout center>
          <div class="idx">{{index | toSingleCharIdx}}</div>
          <div class="value">{{model}}</div>
        </div>
      </template>
    </core-list>
  </template>
  <script>
  (function() {
    var Codes = null;

  /**
   * Nice core-list
   *
   *  Two selection interfaces are available.
   *    - Select by pressing the index of the item.
   *    - Clicking on the item.
   *  Can be canceled using the 'cancel' bus event.
   *  Result:
   *    On closing the menu without a selection, it will send a bus event
   *    with a null item.
   */
  Polymer('widget-list', {
    data: [],
    selection: undefined,

    ready: function() { require(['base/codes'], this.onReady.bind(this)); },
    onReady: function(codes) { Codes = codes; },

    /** On request made. */
    dataChanged: function(oldV, newV) { this.resize(); },
    handleEvent: function(e) {
      var idx = Codes.c2i(String.fromCharCode(event.keyCode || event.which));
      if (idx < 0 || idx >= this.data.length) return;
      this.$.list.selectItem(idx);
    },
    resize: function() {
      this.style.height = (this.data.length * this.$.list.height) + 'px';
    }
  });
  })();
  </script>
</polymer-element>