<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="recipe-graph.html">
<link rel="import" href="recipe-reactor.html">
<link rel="import" href="recipe-tools.html">
<link rel="import" href="recipe-popup.html">
<link rel="import" href="app-shortcuts.html">

<polymer-element name="recipe-overview" vertical layout>
	<template>
    <link rel="stylesheet" href="../css/recipe-overview.css">
		<div class="recipeName">{{recipe.name}}</div>
    <div horizontal layout flex>
      <recipe-graph recipe={{recipe}} flex one></recipe-graph>
      <recipe-reactor reactor={{reactor}} flex four></recipe-reactor>
      <recipe-tools reactor={{reactor}} inventory={{inventory}} flex one></recipe-tools>
    </div>
    <recipe-popup visible={{popupVisible}} hidden?={{!popupVisible}} id="popup">
    </recipe-popup>
    <app-shortcuts id="shortcuts" isHidden={{isShortcutHidden}} hidden?={{isShortcutHidden}}></app-shortcuts>
	</template>
	<script>
    Polymer('recipe-overview', {
      popupVisible: false,
      recipeChanged: function() {
        this.reactor = this.recipe.reactors[0];
      },
      ready: function() {
        require(['recipebuilder'], this.initRecipeBuilder.bind(this))
        window.addEventListener('keyup', this.$.shortcuts.keypress.bind(this.$.shortcuts), true);
      },
      initRecipeBuilder: function(RecipeBuilder) {
        this.builder = new RecipeBuilder();
        this.inventory = this.builder.inventory;
        this.recipe = this.builder.recipe;
      },
    });
  </script>
</polymer-element>