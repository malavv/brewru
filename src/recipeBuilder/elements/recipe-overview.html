<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/core-list/core-list.html">

<polymer-element name="recipe-overview" vertical layout>
	<template>
    <style>
    .step {
      text-align: center;
      background-color: #ccc;
      border-bottom: 1px solid black;
    }
    .name {
      background-color: #333;
      color: #ddd;
    }
    ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    h3 {
      text-align: center;
      background-color: #eee;
      padding: 0;
      margin: 0;
    }
    </style>

		<h1>{{recipe.name}}</h1>
    <div horizontal layout flex>
      <div vertical layout>
        <h2>Reactors</h2>
        <core-list data="{{recipe.reactors}}" flex>
          <template><div>{{model.id}}</div></template>
        </core-list>
        <h2>Composite Ingredients</h2>
        <core-list data="{{recipe.composites}}" flex>
          <template><div>{{model}}</div></template>
        </core-list>
      </div>
      <div vertical layout flex>
        <h2>Procedure</h2>
        <h3>Mashing</h3>
        <core-list data="{{recipe.procedure.mashing}}" flex>
          <template>
            <div class="step">
              <div class="name">{{model.name}} &lt;{{model.id}}&gt;</div>
              <div horizontal layout>
                <div class="inputs" flex>
                  <b>inputs</b>
                  <ul>
                  <template repeat="{{input in model.inputs}}">
                    <li>{{input.container}} -> {{input.item}}({{input.type}})</li>
                  </template>
                  </ul>
                </div>
                <div class="outputs" flex>
                  <b>output</b>
                  <ul>
                  <template repeat="{{output in model.outputs}}">
                    <li>this -> {{output.item}}({{output.type}})</li>
                  </template>
                  </ul>
                </div>
              </div>
            </div>
          </template>
        </core-list>
        <h3>Boiling</h3>
        <core-list data="{{recipe.procedure.boiling}}" flex>
          <template>
            <div class="step">
              <div class="name">{{model.name}} &lt;{{model.id}}&gt;</div>
              <div horizontal layout>
                <div class="inputs" flex>
                  <b>inputs</b>
                  <ul>
                  <template repeat="{{input in model.inputs}}">
                    <li>
                      {{input.container}} -> {{input.item}}({{input.type}})<br>
                      {{input.qty.magnitude}} -- {{input.qty.unit}}
                    </li>
                  </template>
                  </ul>
                </div>
                <div class="outputs" flex>
                  <b>output</b>
                  <ul>
                  <template repeat="{{output in model.outputs}}">
                    <li>this -> {{output.item}}({{output.type}})</li>
                  </template>
                  </ul>
                </div>
              </div>
            </div>
          </template>
        </core-list>
        <h3>Fermenting</h3>
        <core-list data="{{recipe.procedure.fermenting}}" flex>
          <template>
            <div class="step">
              <div class="name">{{model.name}} &lt;{{model.id}}&gt;</div>
              <div horizontal layout>
                <div class="inputs" flex>
                  <b>inputs</b>
                  <ul>
                  <template repeat="{{input in model.inputs}}">
                    <li>{{input.container}} -> {{input.item}}({{input.type}})</li>
                  </template>
                  </ul>
                </div>
                <div class="outputs" flex>
                  <b>output</b>
                  <ul>
                  <template repeat="{{output in model.outputs}}">
                    <li>this -> {{output.item}}({{output.type}})</li>
                  </template>
                  </ul>
                </div>
              </div>
            </div>
          </template>
        </core-list>
        <h3>Packaging</h3>
        <core-list data="{{recipe.procedure.packaging}}" flex>
          <template>
            <div class="step">
              <div class="name">{{model.name}} &lt;{{model.id}}&gt;</div>
              <div horizontal layout>
                <div class="inputs" flex>
                  <b>inputs</b>
                  <ul>
                  <template repeat="{{input in model.inputs}}">
                    <li>{{input.container}} -> {{input.item}}({{input.type}})</li>
                  </template>
                  </ul>
                </div>
                <div class="outputs" flex>
                  <b>output</b>
                  <ul>
                  <template repeat="{{output in model.outputs}}">
                    <li>this -> {{output.item}}({{output.type}})</li>
                  </template>
                  </ul>
                </div>
              </div>
            </div>
          </template>
        </core-list>
      </div>
    </div>

	</template>
	<script>
    Polymer({
      recipe: null,
      ready: function() {
      	var self = this;
        require(['recipe', 'step', 'procedure'], function(Recipe, Step, Procedure) {
          self.recipe = new Recipe('TelePorter');

          self.recipe.procedure.addStep(new Step(
            'Add Water',
            'recipe:addWater',
            Procedure.type.boiling,
            [
              {
                container: 'brew:inventory',
                item: 'anon:0',
                type: 'liquid',
                qty: {
                  magnitude: 23,
                  unit: 'brew:liter'
                }
              }
            ],
            [
              {
                item: 'reactor:0',
                type: 'reactor'
              }
            ]
          ));

          self.recipe.procedure.addStep(new Step(
            'Heat To Boil',
            'recipe:heatToBoil',
            Procedure.type.boiling,
            // Define events here?
            // Then set end on an event?
            [
              {
                container: 'recipe:addWater',
                item: 'reactor:0',
                type: 'reactor'
              }
            ],
            [
              {
                item: 'reactor:0',
                type: 'reactor'
              }
            ]
          ));

          self.recipe.procedure.addStep(new Step(
            'Add Fermentables',
            'recipe:addFermentables',
            Procedure.type.boiling,
            [
              {
                container: 'recipe:heatToBoil',
                item: 'reactor:0',
                type: 'reactor'
              },
              {
                container: 'brew:inventory',
                item: 'anon:1',
                type: 'liquid',
                qty: {
                  magnitude: 3.6,
                  unit: 'brew:kilogram'
                }
              },
              {
                container: 'brew:inventory',
                item: 'anon:2',
                type: 'solid',
                qty: {
                  magnitude: .35,
                  unit: 'brew:kilogram'
                }
              },
              {
                container: 'brew:inventory',
                item: 'anon:3',
                type: 'solid',
                qty: {
                  magnitude: .07,
                  unit: 'brew:kilogram'
                }
              },
              {
                container: 'brew:inventory',
                item: 'anon:4',
                type: 'solid',
                qty: {
                  magnitude: .13,
                  unit: 'brew:kilogram'
                }
              },
              {
                container: 'brew:inventory',
                item: 'anon:5',
                type: 'solid',
                qty: {
                  magnitude: 0.07,
                  unit: 'brew:kilogram'
                }
              }
            ],
            [
              {
                item: 'reactor:0',
                type: 'reactor'
              }
            ]
          ));

        });
      }
    });

  </script>
</polymer-element>