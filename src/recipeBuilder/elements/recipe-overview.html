<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="recipe-graph.html">
<link rel="import" href="recipe-reactor.html">
<link rel="import" href="recipe-tools.html">
<link rel="import" href="recipe-newstep.html">
<link rel="import" href="app-shortcuts.html">
<link rel="import" href="app-menu.html">
<link rel="import" href="app-text.html">
<link rel="import" href="app-ingredient.html">
<link rel="import" href="widget-text.html">

<link rel="import" href="widget-expression.html">

<polymer-element name="recipe-overview" vertical layout>
	<template>
    <link rel="stylesheet" href="../css/recipe-overview.css">
    <widget-text class="recipeName" text={{builder.recipe.name}}></widget-text>
    <div horizontal layout flex>
      <recipe-graph recipe={{builder.recipe}} flex one></recipe-graph>
      <recipe-reactor reactor={{current}} flex four></recipe-reactor>
      <recipe-tools reactor={{current}} inventory={{builder.ingredients}} flex one></recipe-tools>
    </div>
    <app-shortcuts id="shortcuts"></app-shortcuts>
    <app-menu isHidden={{isMenuHidden}} hidden?={{isMenuHidden}}></app-menu>
    <app-text isHidden={{isTextHidden}} hidden?={{isTextHidden}}></app-text>
    <app-ingredient></app-ingredient>
    <recipe-newstep builder={{builder}}></recipe-newstep>
	</template>
	<script>
    Polymer('recipe-overview', {
      ready: function() {
        require(['recipebuilder', 'base/key'], this.onReady.bind(this))
      },
      onReady: function(RecipeBuilder, key) {
        this.initRecipeBuilder(RecipeBuilder);
        window.addEventListener('keyup', this.$.shortcuts.keypress.bind(this.$.shortcuts, key), true);
      },
      initRecipeBuilder: function(RecipeBuilder) {
        this.builder = new RecipeBuilder();
        this.current = this.builder.recipe.reactors[0];
      }
    });
  </script>
</polymer-element>