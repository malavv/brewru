/// <reference path="../../base/log.ts" />
/// <reference path="equipment.ts" />
var Equipments = (function () {
    function Equipments() {
    }
    Equipments.getAll = function () {
        return [];
    };
    return Equipments;
})();
/**
 * Get a specific Style by its unique reference.
 * @param ref Unique Reference of the Style.
 * @returns {Style}
 */
function byRef(ref) {
    return styleByRef[ref];
}
exports.byRef = byRef;
function onServerLoaded(server) {
    var _this = this;
    Log.info("Styles", "Loading Styles");
    server.getStyles()
        .then(function (data) { allGuides = data; })
        .then(loadStyles)
        .then(function () { bus.publish(MessageType.StylesLoaded, _this); });
}
function loadStyles() {
    var styleMap = {};
    var categoryMap = {};
    // Filling temporary maps.
    allGuides.forEach(function (guide) {
        guide.styles.forEach(function (s) { styleMap[s.ref] = s; });
        guide.categories.forEach(function (c) { categoryMap[c.ref] = c; });
    });
    // Fill all styles
    allStyles = _.flatten(_.map(allGuides, function (guide) { return _.flatten(_.map(guide.categories, function (category) { return _.flatten(_.map(category.styles, function (style) { return new Style(guide.ref, category, styleMap[style]); })); })); }));
    // Make Helper Dictionary
    allStyles.forEach(function (s) { styleByRef[s.getRef()] = s; });
}
bus.suscribe(MessageType.ServerConnected, function (server) { onServerLoaded(server); }, null);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImtub3dsZWRnZS9kb21haW4vZXF1aXBtZW50cy50cyJdLCJuYW1lcyI6WyJFcXVpcG1lbnRzIiwiRXF1aXBtZW50cy5jb25zdHJ1Y3RvciIsIkVxdWlwbWVudHMuZ2V0QWxsIiwiYnlSZWYiLCJvblNlcnZlckxvYWRlZCIsImxvYWRTdHlsZXMiXSwibWFwcGluZ3MiOiJBQUFBLDBDQUEwQztBQUMxQyxxQ0FBcUM7QUFFckM7SUFBQUE7SUFXRUMsQ0FQQ0QsQUFPQUM7SUFUYUQsaUJBQU1BLEdBQXBCQTtRQUNFRSxNQUFNQSxDQUFDQSxFQUFFQSxDQUFDQTtJQUNaQSxDQUFDQTtJQU9ERixpQkFBQ0E7QUFBREEsQ0FYRixBQVdHQSxJQVBBO0FBRUQ7Ozs7R0FJRztBQUNILGVBQXNCLEdBQVU7SUFDOUJHLE1BQU1BLENBQUNBLFVBQVVBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO0FBQ3pCQSxDQUFDQTtBQUZlLGFBQUssUUFFcEIsQ0FBQTtBQUVELHdCQUF3QixNQUFhO0lBQXJDQyxpQkFNQ0E7SUFMQ0EsR0FBR0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsUUFBUUEsRUFBRUEsZ0JBQWdCQSxDQUFDQSxDQUFDQTtJQUNyQ0EsTUFBTUEsQ0FBQ0EsU0FBU0EsRUFBRUE7U0FDYkEsSUFBSUEsQ0FBQ0EsVUFBQUEsSUFBSUEsSUFBTUEsU0FBU0EsR0FBUUEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7U0FDeENBLElBQUlBLENBQUNBLFVBQVVBLENBQUNBO1NBQ2hCQSxJQUFJQSxDQUFDQSxjQUFRQSxHQUFHQSxDQUFDQSxPQUFPQSxDQUFDQSxXQUFXQSxDQUFDQSxZQUFZQSxFQUFFQSxLQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtBQUNwRUEsQ0FBQ0E7QUFFRDtJQUNFQyxJQUFJQSxRQUFRQSxHQUE4QkEsRUFBRUEsQ0FBQ0E7SUFDN0NBLElBQUlBLFdBQVdBLEdBQWlDQSxFQUFFQSxDQUFDQTtJQUVuREEsMEJBQTBCQTtJQUMxQkEsU0FBU0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsVUFBQUEsS0FBS0E7UUFDckJBLEtBQUtBLENBQUNBLE1BQU1BLENBQUNBLE9BQU9BLENBQUNBLFVBQUFBLENBQUNBLElBQU1BLFFBQVFBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1FBQ3BEQSxLQUFLQSxDQUFDQSxVQUFVQSxDQUFDQSxPQUFPQSxDQUFDQSxVQUFBQSxDQUFDQSxJQUFNQSxXQUFXQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtJQUM3REEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7SUFFSEEsa0JBQWtCQTtJQUNsQkEsU0FBU0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsT0FBT0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsU0FBU0EsRUFDakNBLFVBQUFBLEtBQUtBLElBQUlBLE9BQUFBLENBQUNBLENBQUNBLE9BQU9BLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEtBQUtBLENBQUNBLFVBQVVBLEVBQ3JDQSxVQUFBQSxRQUFRQSxJQUFJQSxPQUFBQSxDQUFDQSxDQUFDQSxPQUFPQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxRQUFRQSxDQUFDQSxNQUFNQSxFQUN2Q0EsVUFBQUEsS0FBS0EsSUFBSUEsT0FBQUEsSUFBSUEsS0FBS0EsQ0FBQ0EsS0FBS0EsQ0FBQ0EsR0FBR0EsRUFBRUEsUUFBUUEsRUFBRUEsUUFBUUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsRUFBL0NBLENBQStDQSxDQUFDQSxDQUFDQSxFQURsREEsQ0FDa0RBLENBQUNBLENBQUNBLEVBRjNEQSxDQUUyREEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7SUFFM0VBLHlCQUF5QkE7SUFDekJBLFNBQVNBLENBQUNBLE9BQU9BLENBQUNBLFVBQUNBLENBQUNBLElBQU9BLFVBQVVBLENBQUNBLENBQUNBLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO0FBQzVEQSxDQUFDQTtBQUVELEdBQUcsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLGVBQWUsRUFBRSxVQUFDLE1BQU0sSUFBTyxjQUFjLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMiLCJmaWxlIjoiZTovYnJld3J1L3NyYy9idWlsZGVyL2NvcmUva25vd2xlZGdlL2RvbWFpbi9lcXVpcG1lbnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL2Jhc2UvbG9nLnRzXCIgLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cImVxdWlwbWVudC50c1wiIC8+XHJcblxyXG5jbGFzcyBFcXVpcG1lbnRzIHtcclxuXHJcbiAgcHVibGljIHN0YXRpYyBnZXRBbGwoKSA6IEFycmF5PEVxdWlwbWVudD4ge1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGEgc3BlY2lmaWMgU3R5bGUgYnkgaXRzIHVuaXF1ZSByZWZlcmVuY2UuXHJcbiAgICogQHBhcmFtIHJlZiBVbmlxdWUgUmVmZXJlbmNlIG9mIHRoZSBTdHlsZS5cclxuICAgKiBAcmV0dXJucyB7U3R5bGV9XHJcbiAgICovXHJcbiAgZXhwb3J0IGZ1bmN0aW9uIGJ5UmVmKHJlZjpTdHJpbmcpIDogU3R5bGUge1xyXG4gICAgcmV0dXJuIHN0eWxlQnlSZWZbcmVmXTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIG9uU2VydmVyTG9hZGVkKHNlcnZlcjpTZXJ2ZXIpIHtcclxuICAgIExvZy5pbmZvKFwiU3R5bGVzXCIsIFwiTG9hZGluZyBTdHlsZXNcIik7XHJcbiAgICBzZXJ2ZXIuZ2V0U3R5bGVzKClcclxuICAgICAgICAudGhlbihkYXRhID0+IHsgYWxsR3VpZGVzID0gPGFueT5kYXRhOyB9KVxyXG4gICAgICAgIC50aGVuKGxvYWRTdHlsZXMpXHJcbiAgICAgICAgLnRoZW4oKCkgPT4geyBidXMucHVibGlzaChNZXNzYWdlVHlwZS5TdHlsZXNMb2FkZWQsIHRoaXMpOyB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGxvYWRTdHlsZXMoKSB7XHJcbiAgICB2YXIgc3R5bGVNYXAgOiB7W3JlZjpzdHJpbmddOiBSYXdTdHlsZX0gPSB7fTtcclxuICAgIHZhciBjYXRlZ29yeU1hcCA6IHtbcmVmOnN0cmluZ106IFJhd0NhdGVnb3J5fSA9IHt9O1xyXG5cclxuICAgIC8vIEZpbGxpbmcgdGVtcG9yYXJ5IG1hcHMuXHJcbiAgICBhbGxHdWlkZXMuZm9yRWFjaChndWlkZSA9PiB7XHJcbiAgICAgIGd1aWRlLnN0eWxlcy5mb3JFYWNoKHMgPT4geyBzdHlsZU1hcFtzLnJlZl0gPSBzOyB9KTtcclxuICAgICAgZ3VpZGUuY2F0ZWdvcmllcy5mb3JFYWNoKGMgPT4geyBjYXRlZ29yeU1hcFtjLnJlZl0gPSBjOyB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEZpbGwgYWxsIHN0eWxlc1xyXG4gICAgYWxsU3R5bGVzID0gXy5mbGF0dGVuKF8ubWFwKGFsbEd1aWRlcyxcclxuICAgICAgICBndWlkZSA9PiBfLmZsYXR0ZW4oXy5tYXAoZ3VpZGUuY2F0ZWdvcmllcyxcclxuICAgICAgICAgICAgY2F0ZWdvcnkgPT4gXy5mbGF0dGVuKF8ubWFwKGNhdGVnb3J5LnN0eWxlcyxcclxuICAgICAgICAgICAgICAgIHN0eWxlID0+IG5ldyBTdHlsZShndWlkZS5yZWYsIGNhdGVnb3J5LCBzdHlsZU1hcFtzdHlsZV0pKSkpKSkpO1xyXG5cclxuICAgIC8vIE1ha2UgSGVscGVyIERpY3Rpb25hcnlcclxuICAgIGFsbFN0eWxlcy5mb3JFYWNoKChzKSA9PiB7IHN0eWxlQnlSZWZbcy5nZXRSZWYoKV0gPSBzOyB9KTtcclxuICB9XHJcblxyXG4gIGJ1cy5zdXNjcmliZShNZXNzYWdlVHlwZS5TZXJ2ZXJDb25uZWN0ZWQsIChzZXJ2ZXIpID0+IHsgb25TZXJ2ZXJMb2FkZWQoc2VydmVyKTsgIH0sIG51bGwpO1xyXG59Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
