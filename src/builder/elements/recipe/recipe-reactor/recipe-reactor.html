<dom-module id="recipe-reactor">

  <style>
    :host {
      @apply(--layout-horizontal);
      overflow: hidden;
    }
    div.reactor-view {
      overflow: auto;
      padding: 20px 0;
      overflow-x: hidden;
    }
    div#reactor {
      width: 250px;
      margin: 0 auto;
      padding-left: 20px;
    }
    div.desc {
      background-color: #6b6bb8;
      @apply(--layout-flex);
    }
    div.new:hover {
      background-color: #774884;
    }
    div.step {
      width: 180px;
      border: 1px solid blue;
      margin: 1px;
      cursor: pointer;
    }

    div.lvl0 {
      margin-left: -10px;
    }
    div.lvl1 {
      margin-left: 0;
    }
    div.lvl2 {
      margin-left: 10px;
    }
    div.lvl3 {
      margin-left: 20px;
    }

    div.equipment { border-color: blue; }
    div.heating { border-color: red; }
    div.ingredient { border-color: green; }
    div.miscellaneous { border-color: orange; }
    div.fermenting { border-color: yellow; }
    div.cooling { border-color: deepskyblue; }
    div.target { border-color: mediumpurple; }
  </style>

  <template>
    <div class="reactor-view">
      <div id="reactor">
        <template is="dom-repeat" items="{{recipe.reactors}}" as="reactor">
          <div class="step equipment lvl0">{{reactor.equipment.name}}</div>
          <div class="lvl1">
            <template is="dom-repeat" items="{{reactor.steps}}" as="step">
              <div class$="{{_recipeClass(step)}}">{{step.name}}</div>

              <template is="dom-if" if="{{step.isProcess}}">
                <div class="lvl2">
                  <!-- Begin -->
                  <div class$="{{_recipeClass(step.begin)}}">{{step.begin}}</div>
                  <div class="lvl3">
                    <template is="dom-repeat" items="{{step.begin.ingredients}}" as="ing">
                      <div class$="{{_recipeClass(ing)}}">{{ing.name}}</div>
                    </template>
                  </div>

                  <!-- Intermediary -->
                  <template is="dom-repeat" items="{{step.targets}}" as="target">
                    <div class$="{{_recipeClass(target)}}">{{target}}</div>
                    <div class="lvl3">
                      <template is="dom-repeat" items="{{target.ingredients}}" as="ing">
                        <div class$="{{_recipeClass(ing)}}">{{ing.name}}</div>
                      </template>
                    </div>
                  </template>

                  <!-- End -->
                  <div class$="{{_recipeClass(step.end)}}">{{step.end}}</div>
                  <div class="lvl3">
                    <template is="dom-repeat" items="{{step.end.ingredients}}" as="ing">
                      <div class$="{{_recipeClass(ing)}}">{{ing.name}}</div>
                    </template>
                  </div>
                </div>
              </template>
            </template>
          </div>
        </template>
      </div>
    </div>
    <div class="desc">Description zone</div>
  </template>

  <script src="recipe-reactor.js"></script>
</dom-module>